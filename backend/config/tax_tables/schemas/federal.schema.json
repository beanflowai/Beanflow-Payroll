{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "federal.schema.json",
  "title": "Federal Tax Configuration Schema",
  "description": "Schema for validating federal income tax configuration files",
  "type": "object",
  "required": ["year", "effective_date", "source", "bpaf", "cea", "brackets", "k1_rate", "k2_cpp_ei_rate", "k4_canada_employment_rate"],
  "properties": {
    "_metadata": {
      "type": "object",
      "description": "Configuration metadata for traceability"
    },
    "year": {
      "type": "integer",
      "minimum": 2024,
      "maximum": 2100,
      "description": "Tax year"
    },
    "effective_date": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "Effective date in YYYY-MM-DD format"
    },
    "end_date": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "End date for edition validity (optional, for jan edition)"
    },
    "source": {
      "type": "string",
      "minLength": 1,
      "description": "Data source reference"
    },
    "bpaf": {
      "type": "number",
      "minimum": 10000,
      "maximum": 50000,
      "description": "Basic Personal Amount Federal"
    },
    "cea": {
      "type": "number",
      "minimum": 1000,
      "maximum": 5000,
      "description": "Canada Employment Amount"
    },
    "indexing_rate": {
      "type": "number",
      "minimum": 0,
      "maximum": 0.1,
      "description": "Annual indexing rate"
    },
    "brackets": {
      "type": "array",
      "minItems": 4,
      "maxItems": 6,
      "items": {
        "type": "object",
        "required": ["threshold", "rate", "constant"],
        "properties": {
          "threshold": {
            "type": "number",
            "minimum": 0,
            "description": "Income threshold for this bracket"
          },
          "rate": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Tax rate for this bracket (e.g., 0.15 for 15%)"
          },
          "constant": {
            "type": "number",
            "minimum": 0,
            "description": "Tax constant K for this bracket"
          },
          "description": {
            "type": "string"
          }
        },
        "additionalProperties": false
      },
      "description": "Federal tax brackets"
    },
    "k1_rate": {
      "type": "number",
      "minimum": 0,
      "maximum": 0.5,
      "description": "K1 personal credit rate"
    },
    "k2_cpp_ei_rate": {
      "type": "number",
      "minimum": 0,
      "maximum": 0.5,
      "description": "K2 CPP/EI credit rate"
    },
    "k4_canada_employment_rate": {
      "type": "number",
      "minimum": 0,
      "maximum": 0.5,
      "description": "K4 Canada Employment credit rate"
    }
  },
  "additionalProperties": false
}
