{
  "tier": 4,
  "name": "Special Conditions",
  "description": "Tests for RRSP, union dues, exemptions, and taxable benefits",
  "version": "2025-07",
  "collected_date": "2025-12-29",
  "pdoc_version": "T4127 - Version 2025-12-08",
  "tolerance": "0.05",
  "test_cases": [
    {
      "id": "ON_60K_RRSP",
      "tier": 4,
      "description": "Ontario $60k with RRSP $500/period - tax reduction from RRSP",
      "status": "VERIFIED",
      "category": "rrsp",
      "special_rules": [
        "RRSP tax deduction"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "2307.69",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "500.00",
        "union_dues": "0",
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "129.30",
        "cpp_enhancement_f2": "21.73",
        "cpp2": "0.00",
        "ei": "37.85",
        "federal_tax": "134.91",
        "provincial_tax": "75.40",
        "total_deductions": "877.46",
        "net_pay": "1430.23"
      },
      "notes": "RRSP reduces taxable income from 2307.69 to 1785.96"
    },
    {
      "id": "ON_60K_UNION",
      "tier": 4,
      "description": "Ontario $60k with union dues $50/period - tax credit",
      "status": "VERIFIED",
      "category": "union_dues",
      "special_rules": [
        "Union dues tax credit"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "2307.69",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "0",
        "union_dues": "50.00",
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "129.30",
        "cpp_enhancement_f2": "21.73",
        "cpp2": "0.00",
        "ei": "37.85",
        "federal_tax": "199.82",
        "provincial_tax": "112.18",
        "total_deductions": "529.15",
        "net_pay": "1778.54"
      },
      "notes": "Union dues provide tax credit, taxable income 2235.96"
    },
    {
      "id": "AB_80K_RRSP",
      "tier": 4,
      "description": "Alberta $80k with RRSP $1000/period - high RRSP deduction",
      "status": "VERIFIED",
      "category": "rrsp",
      "special_rules": [
        "High RRSP",
        "Alberta flat rate"
      ],
      "input": {
        "province": "AB",
        "gross_pay": "3076.92",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "22323.00",
        "rrsp": "1000.00",
        "union_dues": "0",
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "175.07",
        "cpp_enhancement_f2": "29.42",
        "cpp2": "0.00",
        "ei": "50.46",
        "federal_tax": "168.01",
        "provincial_tax": "61.10",
        "total_deductions": "1454.64",
        "net_pay": "1622.28"
      },
      "notes": "RRSP reduces taxable income from 3076.92 to 2047.50"
    },
    {
      "id": "ON_60K_CPP_EXEMPT",
      "tier": 4,
      "description": "Ontario $60k CPP exempt - no CPP contribution",
      "status": "VERIFIED",
      "category": "exemptions",
      "special_rules": [
        "CPP exempt"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "2307.69",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "0",
        "union_dues": "0",
        "cpp_exempt": true,
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "0.00",
        "cpp_enhancement_f2": "0.00",
        "cpp2": "0.00",
        "ei": "37.85",
        "federal_tax": "229.59",
        "provincial_tax": "124.18",
        "total_deductions": "391.62",
        "net_pay": "1916.07"
      },
      "notes": "CPP exempt employee - no CPP contributions, EI still applies"
    },
    {
      "id": "ON_60K_EI_EXEMPT",
      "tier": 4,
      "description": "Ontario $60k EI exempt - no EI contribution",
      "status": "VERIFIED",
      "category": "exemptions",
      "special_rules": [
        "EI exempt"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "2307.69",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "0",
        "union_dues": "0",
        "ei_exempt": true,
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "129.30",
        "cpp_enhancement_f2": "21.73",
        "cpp2": "0.00",
        "ei": "0.00",
        "federal_tax": "215.37",
        "provincial_tax": "118.67",
        "total_deductions": "463.34",
        "net_pay": "1844.35"
      },
      "notes": "EI exempt employee - CPP still applies, insurable earnings 0.00"
    },
    {
      "id": "ON_100K_CPP2_EXEMPT",
      "tier": 4,
      "description": "Ontario $100k CPP2 exempt - no additional CPP",
      "status": "VERIFIED",
      "category": "exemptions",
      "special_rules": [
        "CPP2 exempt only"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "3846.15",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "0",
        "union_dues": "0",
        "cpp2_exempt": true,
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "220.84",
        "cpp_enhancement_f2": "37.12",
        "cpp2": "0.00",
        "ei": "63.08",
        "federal_tax": "518.79",
        "provincial_tax": "263.05",
        "total_deductions": "1065.76",
        "net_pay": "2780.39"
      },
      "notes": "PDOC doesn't have CPP2 exempt option. With ytd=0, CPP2=0 naturally since YMPE ($71,300) threshold not reached. Base CPP and F2 still apply."
    },
    {
      "id": "ON_60K_BENEFITS",
      "tier": 4,
      "description": "Ontario $60k with taxable benefits $100 - benefits taxability",
      "status": "VERIFIED",
      "category": "taxable_benefits",
      "special_rules": [
        "Taxable benefits"
      ],
      "input": {
        "province": "ON",
        "gross_pay": "2307.69",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12747.00",
        "rrsp": "0",
        "union_dues": "0",
        "taxable_benefits": "100.00",
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "135.25",
        "cpp_enhancement_f2": "22.73",
        "cpp2": "0.00",
        "ei": "39.49",
        "federal_tax": "229.44",
        "provincial_tax": "125.48",
        "total_deductions": "529.66",
        "net_pay": "1878.03"
      },
      "notes": "Updated 2025-12-30 - Cash taxable benefit ($100) included in Total cash income → Net amount."
    },
    {
      "id": "BC_40K_BENEFITS",
      "tier": 4,
      "description": "BC $40k with taxable benefits + low income - combined with tax reduction",
      "status": "VERIFIED",
      "category": "taxable_benefits",
      "special_rules": [
        "Taxable benefits",
        "BC tax reduction interaction"
      ],
      "input": {
        "province": "BC",
        "gross_pay": "1538.46",
        "pay_frequency": "biweekly",
        "pay_periods": 26,
        "pay_date": "2025-07-18",
        "federal_claim": "16129.00",
        "provincial_claim": "12932.00",
        "rrsp": "0",
        "union_dues": "0",
        "taxable_benefits": "100.00",
        "ytd_gross": "0",
        "ytd_pensionable_earnings": "0",
        "ytd_insurable_earnings": "0",
        "ytd_cpp_base": "0",
        "ytd_cpp_additional": "0",
        "ytd_ei": "0"
      },
      "pdoc_expected": {
        "cpp_total": "89.48",
        "cpp_enhancement_f2": "15.04",
        "cpp2": "0.00",
        "ei": "26.87",
        "federal_tax": "118.33",
        "provincial_tax": "51.85",
        "total_deductions": "286.53",
        "net_pay": "1351.93"
      },
      "notes": "Updated 2025-12-30 - Cash taxable benefit ($100) included in Total cash income → Net amount."
    }
  ]
}