# Pay Groups 完整设计方案 - 世界级 Payroll 应用

> **Status**: 设计规划中
> **Last Updated**: 2025-12-11
> **Goal**: 设计一个现代化、用户体验极佳的完整 Payroll 系统

---

## 设计理念

### 核心原则

1. **Policy-First Architecture** - Pay Group 作为"政策模板"，而非简单分组
2. **Progressive Disclosure** - 渐进式展示复杂性，新手友好但功能完整
3. **Smart Defaults** - 基于省份自动设置合规默认值
4. **Visual Clarity** - 清晰的信息层级，一目了然的状态展示

### 与竞品对比的差异化

| 特性 | Wagepoint | QuickBooks | ADP | **BeanFlow (目标)** |
|------|-----------|------------|-----|---------------------|
| Pay Group 概念 | 基础分组 | 无明确概念 | Policy-based | **Policy Templates** |
| WCB 集成 | 手动 | 自动计算 | 复杂配置 | **智能推荐 + 自动计算** |
| 福利管理 | 基础 | 有限 | 企业级 | **可视化配置 + 成本预览** |
| 省份合规 | 好 | 好 | 优秀 | **实时合规检查 + 提示** |
| 用户体验 | 中等 | 简单 | 复杂 | **现代化 + 渐进式** |

---

## 完整功能架构

### Pay Group 重新定义

**从"分组"升级为"政策模板 (Policy Template)"**

一个 Pay Group 应该完整定义：

```
Pay Group = 薪资周期设置
          + 法定扣款政策 (CPP/EI/Tax)
          + 加班与调休政策
          + WCB/工伤保险配置
          + 福利扣款配置
          + 自定义扣款
          + 假期与休假政策
```

### 功能模块总览

| 模块 | 描述 | 复杂度 |
|------|------|--------|
| **Basic Info** | 名称、频率、类型、下次发薪日 | ⭐ |
| **Statutory Defaults** | CPP/EI/税务豁免默认设置 | ⭐⭐ |
| **Overtime & Bank Time** | 加班费率、调休政策、省份规则 | ⭐⭐ |
| **WCB/WSIB** | 工伤保险行业分类、费率 | ⭐⭐⭐ |
| **Group Benefits** | 健康/牙科/视力/人寿保险 | ⭐⭐⭐ |
| **Custom Deductions** | 停车费、会费、RRSP等自定义扣款 | ⭐⭐ |
| **Leave & Vacation** | 假期政策、累积规则 | ⭐⭐ |

---

## 研究发现总结

### 加拿大 Payroll 法规要点

#### CPP/EI 豁免情况
| 豁免类型 | 适用情况 | 所需表格 |
|----------|----------|----------|
| CPP 豁免 | 65岁以上员工可选择停止缴纳 | - |
| CPP2 豁免 | 有第二份工作且已达上限的员工 | CPT30 |
| EI 豁免 | 拥有>40%股权的所有者、关联方 | - |
| 宗教豁免 | 自雇人员因宗教原因 | CPT16/CPT17 |

#### WCB/WSIB 各省费率 (2025)
| 省份 | 平均费率 | 最高可评估收入 |
|------|----------|----------------|
| Ontario | $1.25/$100 | $112,500 |
| BC | $1.55/$100 | $116,700 |
| Alberta | ~$1.00/$100 | $102,100 |
| Saskatchewan | $1.28/$100 | $96,945 |
| Manitoba | $0.95/$100 | $163,400 |

#### Bank Time (调休) 各省规则
| 省份 | 是否允许 | 银行比率 | 使用期限 |
|------|----------|----------|----------|
| Ontario | ✅ | 1:1.5 | 3个月 |
| BC | ✅ | 1:1.5 | 6个月 |
| Alberta | ✅ | 1:1 | 6个月 |
| Saskatchewan | ✅ | 1:1.5 | 12个月 |
| Federal | ✅ | 1:1.5 | 3-12个月 |

### 竞品分析

| 功能 | Wagepoint | QuickBooks | ADP | Payworks |
|------|-----------|------------|-----|----------|
| Pay Group 概念 | ✅ 基础 | ❌ 无 | ✅ Policy | ✅ 基础 |
| 自定义扣款 | ✅ | ✅ | ✅ 60+种 | ✅ |
| WCB 集成 | 手动 | ✅ 自动 | ✅ 复杂 | ✅ |
| 福利管理 | 基础 | 基础 | 企业级 | ✅ 同步 |
| Bank Time | ❌ | ❌ | ✅ | ✅ |
| 省份合规提示 | ✅ | ✅ | ✅ | ✅ |

**关键洞察：**
- ADP 的 Policy-based 方法最完整，但 UX 复杂
- Wagepoint UX 友好但功能有限
- QuickBooks 无明确 Pay Group 概念，不利于多种薪资周期管理
- **机会：结合 ADP 的完整性 + Wagepoint 的易用性**

---

## 完整 UI/UX 设计方案

### 设计建议：采用 **Full-Page 详情页** 而非 Modal

**理由**：
- Pay Group 现在包含 6-7 个配置模块，Modal 空间不足
- 更好的信息层级展示
- 支持未来扩展更多配置
- 符合现代 SaaS 应用设计趋势 (Notion, Linear, Figma)

### 信息架构

```
Company Page
├── Tab 1: Profile (现有)
├── Tab 2: Pay Groups (现有，增强)
│   └── Pay Group List
│       └── 点击 → Pay Group 详情页 (新)
└── Tab 3: Integration (现有)

Pay Group 详情页 (新)
├── Header: 名称 + 状态徽章 + 操作按钮
├── Summary Cards: 关键配置概览
├── Section 1: 基本信息
├── Section 2: 法定扣款政策
├── Section 3: 加班与调休政策
├── Section 4: WCB/工伤保险
├── Section 5: 福利配置
├── Section 6: 自定义扣款
└── Section 7: 员工列表预览
```

---

## Pay Group 列表页面 (增强版)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ Pay Groups                                                                   │
│                                                                             │
│ 员工按薪资周期和政策分组，每个 Pay Group 单独运行薪资计算                        │
│                                                           [+ 新建 Pay Group]  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│ ┌─────────────────────────────────────────────────────────────────────────┐ │
│ │                                                                         │ │
│ │  ┌─────────────────────────────────────────────────────────────────┐   │ │
│ │  │ Bi-weekly Full-time                                              │   │ │
│ │  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │ │
│ │  │                                                                  │   │ │
│ │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │   │ │
│ │  │  │ 频率     │  │ 类型     │  │ 下次发薪 │                       │   │ │
│ │  │  │ 双周     │  │ 全职     │  │ Dec 15   │                       │   │ │
│ │  │  └──────────┘  └──────────┘  └──────────┘                       │   │ │
│ │  │                                                                  │   │ │
│ │  │  ┌─────────────────────────────────────────────────────────┐    │   │ │
│ │  │  │ 政策配置                                                 │    │   │ │
│ │  │  │ ✅ WCB  ✅ 福利  ✅ 调休  ⚪ CPP豁免  ⚪ EI豁免          │    │   │ │
│ │  │  └─────────────────────────────────────────────────────────┘    │   │ │
│ │  │                                                         [查看 →] │   │ │
│ │  │                                                                  │   │ │
│ │  └─────────────────────────────────────────────────────────────────┘   │ │
│ │                                                                         │ │
│ │  ┌─────────────────────────────────────────────────────────────────┐   │ │
│ │  │ Monthly Executives                                               │   │ │
│ │  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │ │
│ │  │                                                                  │   │ │
│ │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │   │ │
│ │  │  │ 频率     │  │ 类型     │  │ 下次发薪 │                       │   │ │
│ │  │  │ 月付     │  │ 全职     │  │ Dec 31   │                       │   │ │
│ │  │  └──────────┘  └──────────┘  └──────────┘                       │   │ │
│ │  │                                                                  │   │ │
│ │  │  ┌─────────────────────────────────────────────────────────┐    │   │ │
│ │  │  │ 政策配置                                                 │    │   │ │
│ │  │  │ ✅ WCB  ✅ 福利  ⚪ 调休  ⚪ CPP豁免  ✅ EI豁免          │    │   │ │
│ │  │  └─────────────────────────────────────────────────────────┘    │   │ │
│ │  │                                                         [查看 →] │   │ │
│ │  │                                                                  │   │ │
│ │  └─────────────────────────────────────────────────────────────────┘   │ │
│ │                                                                         │ │
│ └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**设计亮点**：
1. **政策徽章行** - 一眼看出哪些政策已启用
2. **移除员工数** - Pay Group 作为纯配置模板
3. **点击整个卡片** → 进入详情页

---

## Pay Group 详情页 (全新设计)

### Header 区域

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ ← 返回 Pay Groups                                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │   📋  Bi-weekly Full-time                                              │ │
│  │       ──────────────────────                                           │ │
│  │       双周发薪 · 全职员工                                               │ │
│  │                                                                        │ │
│  │   ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │   │ 下次发薪日: 2025年12月15日 (4天后)                               │ │ │
│  │   │ 薪资周期: 12月2日 - 12月15日                                     │ │ │
│  │   └─────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                        │ │
│  │                              [编辑基本信息]  [删除]                     │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Summary Cards (关键配置概览)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────┐│
│  │ 🏛️ 法定扣款     │  │ 💼 WCB保险      │  │ 🏥 团体福利     │  │ 📝 自定义││
│  │                 │  │                 │  │                 │  │  扣款   ││
│  │ 标准           │  │ ✅ 已启用        │  │ 4 项已配置      │  │  3 项   ││
│  │ (无豁免)        │  │ $0.25/$100      │  │                 │  │         ││
│  │                 │  │                 │  │                 │  │         ││
│  │ [查看详情]      │  │ [查看详情]      │  │ [查看详情]      │  │ [查看]  ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────┘│
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 1: 基本信息

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 基本信息                                                           [编辑]   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────────────────┐  ┌──────────────────────────┐                │
│  │ 名称                     │  │ 描述                     │                │
│  │ Bi-weekly Full-time      │  │ 标准双周全职员工薪资组    │                │
│  └──────────────────────────┘  └──────────────────────────┘                │
│                                                                             │
│  ┌──────────────────────────┐  ┌──────────────────────────┐                │
│  │ 薪资频率                 │  │ 员工类型                 │                │
│  │ 双周 (26期/年)           │  │ 全职                     │                │
│  └──────────────────────────┘  └──────────────────────────┘                │
│                                                                             │
│  ┌──────────────────────────┐  ┌──────────────────────────┐                │
│  │ 下次发薪日               │  │ 周期起始日               │                │
│  │ 2025年12月15日           │  │ 周一                     │                │
│  └──────────────────────────┘  └──────────────────────────┘                │
│                                                                             │
│  ┌──────────────────────────────────────────────────────────────┐          │
│  │ 假期追踪                                              ✅ 启用 │          │
│  │ 按省份就业标准法自动计算年假                                  │          │
│  └──────────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 2: 法定扣款政策

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 法定扣款政策                                                       [编辑]   │
│ 设置新员工加入时的默认豁免状态                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🏛️ 加拿大养老金计划 (CPP)                                          │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  CPP 默认豁免                                              ⚪ 关闭  │   │
│  │  新员工默认需缴纳 CPP                                               │   │
│  │                                                                     │   │
│  │  CPP2 默认豁免 (多份工作)                                   ⚪ 关闭  │   │
│  │  适用于在其他雇主处已缴满 CPP 的员工                                 │   │
│  │                                                                     │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │ 💡 豁免适用于: 65岁以上员工、已提交CPT30表格的员工           │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 📋 就业保险 (EI)                                                   │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  EI 默认豁免                                               ⚪ 关闭  │   │
│  │  新员工默认需缴纳 EI                                                │   │
│  │                                                                     │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │ 💡 豁免适用于: 持股>40%的所有者、关联方雇佣关系              │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 3: 加班与调休政策

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 加班与调休政策                                                     [编辑]   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │  启用调休 (Bank Time / TOIL)                               ✅ 启用  │   │
│  │  允许员工将加班时间存入调休账户而非直接支付加班费                    │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ ⚠️ 法律要求                                                        │   │
│  │ 调休需要与每位员工签订书面协议。员工可随时选择领取加班费。           │   │
│  │                                                                     │   │
│  │ 当前省份: Ontario                                                   │   │
│  │ 最低银行比率: 1.5:1 | 使用期限: 3个月                              │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌──────────────────────────┐  ┌──────────────────────────┐                │
│  │ 银行比率                 │  │ 调休到期时间             │                │
│  │                         │  │                         │                │
│  │  ┌─────────────────┐    │  │  ┌─────────────────┐    │                │
│  │  │ 1.5:1 (推荐) ▼  │    │  │  │ 3 个月      ▼   │    │                │
│  │  └─────────────────┘    │  │  └─────────────────┘    │                │
│  │                         │  │                         │                │
│  │  每加班1小时 = 1.5小时   │  │  未使用的调休必须在此    │                │
│  │  调休                   │  │  期限前支付              │                │
│  └──────────────────────────┘  └──────────────────────────┘                │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 📄 需要书面协议                                            ✅ 是    │   │
│  │ 系统将在员工入职时提示签署调休协议                                  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 4: WCB/工伤保险

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 工伤保险 (WCB/WSIB)                                                [编辑]   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │  此组员工受 WCB/WSIB 保障                                   ✅ 启用  │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  行业分类                                                                   │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🔍 搜索行业代码或名称...                                            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │  已选择行业                                                         │   │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │   │
│  │                                                                     │   │
│  │  NAICS 72300 - 办公行政服务                                         │   │
│  │  Office Administrative Services                                     │   │
│  │                                                                     │   │
│  │  ┌───────────────────┐  ┌───────────────────┐                      │   │
│  │  │ 2025 评估费率     │  │ 最高可评估收入    │                      │   │
│  │  │                   │  │                   │                      │   │
│  │  │ $0.25/$100       │  │ $112,500         │                      │   │
│  │  └───────────────────┘  └───────────────────┘                      │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ ℹ️ WCB 费率由 Ontario (WSIB) 根据行业风险分类设定                    │   │
│  │    费率每年更新。当前显示 2025 年费率。                              │   │
│  │    [查看 WSIB 官方费率表 ↗]                                         │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ── 或者手动输入费率 ────────────────────────────────────────────────────   │
│                                                                             │
│  ┌──────────────────────────┐                                              │
│  │ 自定义费率 (每$100薪资)  │                                              │
│  │ $ 0.25                   │                                              │
│  └──────────────────────────┘                                              │
│  如果您知道准确费率，可直接输入                                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 5: 福利配置

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 团体福利                                                           [编辑]   │
│ 配置此组员工的福利扣款                                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │  启用团体福利                                               ✅ 启用  │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🏥 健康保险                                               ✅ 启用  ▼ │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌────────────────────────┐  ┌────────────────────────┐            │   │
│  │  │ 员工扣款 (每期)        │  │ 雇主供款 (每期)        │            │   │
│  │  │ $ 50.00               │  │ $ 150.00              │            │   │
│  │  └────────────────────────┘  └────────────────────────┘            │   │
│  │                                                                     │   │
│  │  税务处理: ✅ 非应税 (健康保险保费通常非应税)                        │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🦷 牙科保险                                               ✅ 启用  ▶ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 👁️ 视力保险                                               ⚪ 未启用 ▶ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🛡️ 人寿保险                                               ✅ 启用  ▶ │   │
│  │ ⚠️ 雇主供款部分为应税福利                                           │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 🏥 伤残保险 (短期/长期)                                    ⚪ 未启用 ▶ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### Section 6: 自定义扣款

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 自定义扣款                                                         [编辑]   │
│ 添加此组的额外扣款项目                                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │  │ 扣款名称         │ 类型    │ 金额      │ 默认启用 │ 操作      │   │   │
│  │  │─────────────────│────────│──────────│─────────│──────────│   │   │
│  │  │ 停车费           │ 税后    │ $50.00   │ ✅       │ [编辑]    │   │   │
│  │  │ 工会会费         │ 税前    │ $45.00   │ ✅       │ [编辑]    │   │   │
│  │  │ 健身房会员       │ 税后    │ $25.00   │ ⚪       │ [编辑]    │   │   │
│  │  │ 慈善捐款         │ 税前    │ 1%       │ ⚪       │ [编辑]    │   │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ + 添加自定义扣款                                                    │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ ℹ️ 提示                                                             │   │
│  │ • 税前扣款 (Pre-tax): 从应税收入中扣除，降低员工税负                 │   │
│  │ • 税后扣款 (Post-tax): 从税后净收入中扣除                           │   │
│  │ • 默认启用: 新员工自动应用此扣款                                    │   │
│  │ • 每位员工可在个人资料中覆盖这些设置                                │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 新建 Pay Group 流程 (Full-Page)

采用 **Full-Page 新建页面** 而非 Modal 或向导式流程，让用户在一个完整页面中配置所有选项：

### 用户流程

```
/company?tab=pay-groups          → 列表页
    ↓ 点击 "Add Group"
/company/pay-groups/new          → 新建页面 (Full-Page)
    ↓ 填写配置，点击 "Create Pay Group"
/company/pay-groups/[newId]      → 详情页 (可继续配置)
```

### 新建页面设计

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ ← Back to Pay Groups                                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │  [+]  New Pay Group                                                    │ │
│  │       Configure your new pay group                                     │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ Basic Information                                        [展开编辑模式] │ │
│  │ ──────────────────────────────────────────────────────────────────────  │ │
│  │ (默认展开编辑模式，用户填写必填项)                                      │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ Statutory Defaults                                              [Edit] │ │
│  │ (显示默认值: 无豁免)                                                    │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ Overtime & Bank Time                                            [Edit] │ │
│  │ (显示默认值: 未启用调休)                                                │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ WCB/Workers Compensation                                        [Edit] │ │
│  │ (显示默认值: 未启用)                                                    │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ Group Benefits                                                  [Edit] │ │
│  │ (显示默认值: 未启用)                                                    │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ Custom Deductions                                               [Edit] │ │
│  │ (显示默认值: 无自定义扣款)                                              │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                                          [Cancel]  [Create Pay Group]       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 设计要点

1. **BasicInfo Section 默认展开编辑模式** - 用户首先填写必填项（名称、频率、下次发薪日）
2. **其他 Section 收起显示默认值** - 用户可选择性展开配置
3. **底部固定操作栏** - Cancel 和 Create Pay Group 按钮
4. **保存后跳转到详情页** - 用户可继续配置其他政策选项

---

## 数据模型 (完整版 TypeScript)

```typescript
// ============================
// Pay Group 完整接口定义
// ============================

interface PayGroup {
  // === 基础字段 (现有) ===
  id: string;
  companyId: string;
  name: string;
  description?: string;                 // 新增: 描述
  payFrequency: PayFrequency;
  employmentType: EmploymentType;
  nextPeriodEnd: string;                // Period end date (pay date calculated from this)
  periodStartDay: PeriodStartDay;

  // === 假期追踪 (现有) ===
  leaveEnabled: boolean;

  // === 法定扣款默认设置 (新增) ===
  statutoryDefaults: {
    cppExemptByDefault: boolean;        // CPP 默认豁免
    cpp2ExemptByDefault: boolean;       // CPP2 多份工作豁免
    eiExemptByDefault: boolean;         // EI 默认豁免
  };

  // === 加班与调休政策 (新增) ===
  overtimePolicy: {
    bankTimeEnabled: boolean;           // 启用调休
    bankTimeRate: 1.0 | 1.5;           // 银行比率
    bankTimeExpiryMonths: 3 | 6 | 12;   // 到期月数
    requireWrittenAgreement: boolean;   // 需要书面协议
  };

  // === WCB/工伤保险配置 (新增) ===
  wcbConfig: {
    enabled: boolean;                   // 是否受 WCB 保障
    industryClassCode?: string;         // 行业分类代码 (NAICS)
    industryName?: string;              // 行业名称
    assessmentRate: number;             // 费率 (每$100薪资)
    maxAssessableEarnings?: number;     // 最高可评估收入
  };

  // === 团体福利配置 (新增) ===
  groupBenefits: {
    enabled: boolean;
    health: BenefitConfig;
    dental: BenefitConfig;
    vision: BenefitConfig;
    lifeInsurance: LifeInsuranceConfig;
    disability: BenefitConfig;
  };

  // === 自定义扣款 (新增) ===
  customDeductions: CustomDeduction[];

  // === 元数据 ===
  createdAt: string;
  updatedAt: string;
}

interface BenefitConfig {
  enabled: boolean;
  employeeDeduction: number;
  employerContribution: number;
  isTaxable: boolean;
}

interface LifeInsuranceConfig extends BenefitConfig {
  coverageAmount: number;
  coverageMultiplier?: number;
}

interface CustomDeduction {
  id: string;
  name: string;
  type: 'pre_tax' | 'post_tax';
  calculationType: 'fixed' | 'percentage';
  amount: number;
  isEmployerContribution: boolean;
  isDefaultEnabled: boolean;
  description?: string;
}
```

**注意**: 移除了 `employeeCount` 字段，因为 Pay Group 现在是纯政策模板，员工关联在 Payroll Run 时动态选择。

---

## 文件结构规划

```
payroll-frontend/src/
├── lib/
│   ├── types/
│   │   └── pay-group.ts              # 更新: 完整 PayGroup 类型
│   │
│   └── components/company/
│       ├── PayGroupsTab.svelte       # 更新: 增强卡片显示
│       ├── PayGroupCard.svelte       # 更新: 显示政策徽章
│       ├── PayGroupModal.svelte      # 删除或保留简单创建
│       └── PayGroupDeleteModal.svelte # 保持不变
│
├── routes/(app)/company/
│   ├── +page.svelte                  # 现有: Company 页面
│   └── pay-groups/
│       └── [id]/
│           └── +page.svelte          # 新增: Pay Group 详情页
│
└── docs/planning/payroll/ui/
    └── 08_pay_groups.md              # 更新: 新设计文档
```

---

## 设计亮点总结

### 1. 信息架构升级
- **列表页**: 快速概览，政策徽章一目了然
- **详情页**: 分 Section 展示完整配置
- **向导式创建**: 引导新用户完成完整配置

### 2. 用户体验优化
- **渐进式披露**: 默认显示关键信息，详情可展开
- **智能默认值**: 基于省份自动设置合规默认值
- **合规提示**: 法律要求一目了然

### 3. 现代化设计
- **Full-page 详情**: 符合 Notion/Linear 设计趋势
- **Summary Cards**: 关键配置可视化
- **Accordion 福利**: 节省空间，按需展开
- **政策徽章**: 快速识别已启用功能

### 4. 完整功能覆盖
- ✅ 基本信息 (现有增强)
- ✅ 法定扣款豁免 (CPP/EI)
- ✅ 加班与调休政策 (Bank Time)
- ✅ WCB/工伤保险
- ✅ 团体福利 (健康/牙科/视力/人寿/伤残)
- ✅ 自定义扣款

---

## 参考资源

### 官方文档
- [CRA CPP 费率](https://www.canada.ca/en/revenue-agency/services/tax/businesses/topics/payroll/payroll-deductions-contributions/canada-pension-plan-cpp/cpp-contribution-rates-maximums-exemptions.html)
- [CRA EI 费率](https://www.canada.ca/en/revenue-agency/services/tax/businesses/topics/payroll/payroll-deductions-contributions/employment-insurance-ei/ei-premium-rates-maximums.html)
- [WorkSafeBC 2025 费率](https://www.worksafebc.com/en/insurance/know-coverage-costs/industry-premium-rates/2025-rates)
- [WSIB Ontario 2025 费率](https://www.wsib.ca/en/2025premiumrates)

### 竞品参考
- [Wagepoint Deductions Guide](https://wagepoint.com/blog/a-comprehensive-list-of-all-payroll-deductions-you-need-to-know/)
- [QuickBooks WCB Setup](https://quickbooks.intuit.com/learn-support/en-ca/help-article/workers-compensation/set-edit-workers-compensation/L2pBul3a5_CA_en_CA)
- [ADP Deduction Policies](https://marketplace-cdn.adp.com/dev-portal/pdf/protected/Deduction_Instruction_Guide_for_ADP_Workforce_Now_Next_Gen)
- [Payworks Benefits](https://www.payworks.ca/solutions/benefits)

### 省份规则
- [Bank Time Guide](https://blog.payworks.ca/the-ins-and-outs-of-banking-overtime-in-canada)
- [CRA Benefits Tax Treatment](https://www.canada.ca/en/revenue-agency/services/tax/businesses/topics/payroll/benefits-allowances/benefits-allowances-chart/premiums-contributions.html)
